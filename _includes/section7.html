<h2>7. Implement SEACell package for scEP data </h2>
<h3>7.1 Summary of SEACell and its pipeline</h3>
<p>
    SEACell is a python script to solve single Cell
    sparsity problem by integrating single cells to metacell.
    The input file for the SEACell script a cell-peak matrix.
    (In the SEACells paper, the cell-peak matrix was generated 
    by ArchR.)
    The output file is metacell that grouped by the SEACell model
</p>

<p>
    Please refer the 
    <a
        href="https://github.com/dpeerlab/SEACells"
        target="_blank"
        rel="noopener noreferrer"
        >SEACell GitHub repo
    </a>
    page to install the package.
</p>

<h3>7.2 scTAG&CUT data preprocessing</h3>
<p>
    <b>
        Notice: The author determine the
        peak using NFR fragments with a customized ArchR version
        that can be found
        <a
        href="https://github.com/dpeerlab/SEACells"
        target="_blank"
        rel="noopener noreferrer"
        > here 
        </a>.
    </b>
</p>

<p>
    ArchR installation:
</p>
<code>
    library(devtools)
    devtools::install_github("GreenleafLab/ArchR", ref="master", repos = BiocManager::repositories())
</code>

<p>
    Update your ArchR with the customized version (The customized version can be found above with GitHub link)
</p>

<code>
# 1 make sure BiocManager is installed
if (!requireNamespace("BiocManager", quietly=TRUE))
    install.packages("BiocManager")

# 2 install the missing Bioconductor packages
BiocManager::install(c(
  "motifmatchr",
  "chromVAR",
  "ComplexHeatmap"
))

# 3 (re)install ArchR from GitHub
if (!requireNamespace("devtools", quietly=TRUE))
    install.packages("devtools")

devtools::install_github(
  "dpeerlab/ArchR",
  lib = "/home/xai/R/x86_64-pc-linux-gnu-library/4.3",
  repos = BiocManager::repositories()
)

</code>