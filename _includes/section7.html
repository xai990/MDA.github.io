<h2>7. Implement the SEACell Package for scEP Data</h2>

<h3>7.1 Overview of SEACell and Its Pipeline</h3>
<p>
  SEACell is a Python tool designed to mitigate single-cell sparsity by aggregating individual cells into “metacells.”  
  It takes as input a cell-by-peak matrix (in the SEACell paper, this matrix is generated using ArchR) and outputs a set of metacells grouped by the SEACell algorithm.
</p>
<p>
  To install SEACell, please visit the  
  <a href="https://github.com/dpeerlab/SEACells" target="_blank" rel="noopener noreferrer">
    SEACell GitHub repository
  </a>.
</p>

<h3>7.2 Preprocessing scTAG & CUT Data</h3>
<p>
  <strong>Note:</strong> Peaks are called using NFR fragments with a customized version of ArchR.  
  You can find this custom ArchR build  
  <a href="https://github.com/dpeerlab/SEACells" target="_blank" rel="noopener noreferrer">
    here
  </a>.
</p>

<h4>Standard ArchR Installation</h4>
<pre><code class="language-r">
# Install devtools if needed
if (!requireNamespace("devtools", quietly = TRUE)) {
  install.packages("devtools")
}

# Install ArchR from GreenleafLab’s GitHub
devtools::install_github(
  "GreenleafLab/ArchR",
  ref    = "master",
  repos  = BiocManager::repositories()
)
</code></pre>

<p>Next, install the customized ArchR version:</p>

<pre><code class="language-r">
# 1. Ensure BiocManager is installed
if (!requireNamespace("BiocManager", quietly = TRUE)) {
  install.packages("BiocManager")
}

# 2. Install required Bioconductor packages
BiocManager::install(c(
  "motifmatchr",
  "chromVAR",
  "ComplexHeatmap"
))

# 3. (Re)install the customized ArchR build
if (!requireNamespace("devtools", quietly = TRUE)) {
  install.packages("devtools")
}

devtools::install_github(
  "dpeerlab/ArchR",
  lib   = "/home/xai/R/x86_64-pc-linux-gnu-library/4.3",
  repos = BiocManager::repositories()
)
</code></pre>

<p>
  <strong>Important:</strong>  
  The customized ArchR may not be fully compatible with the upstream release, as upstream ArchR may receive updates that the custom build lacks.  
  Projects saved with the original ArchR functions will not load under the customized version.  
  To avoid incompatibilities, rerun <code>createArrowFiles()</code> and re-save your ArchR project using the customized build.
</p>
