<h2>8. &nbsp;Week Jun 26 </h2>
<h3>8.1&nbsp; Overview of week tasks</h3>
<ul>
  <li>Create Arrow files with <code>minFrags</code> = 300 and 500, noting how many cells are discarded.</li>
  <li>Generate a bin-by-cell matrix that uses the same genomic bins as the UMAP plot.</li>
  <li>Implement a baseline aggregation algorithm and evaluate its performance.</li>
  <li>Build an <code>AnnData</code> object, run the SEACells model, and visualize the results.</li>
  <li>Repeat the entire pipeline on H3K27 data.</li>
</ul>

<h3>8.2 &nbsp;Identify and remove outliers</h3>
<ol>
  <li>Generate Arrow files with <code>minFrags = 300/500</code> âœ“</li>
  <li>Detect outliers via unsupervised clustering.</li>
</ol>

<p>
  The experiment compared two <code>minFrags</code> thresholds (300 vs&nbsp;500).  
  After removing outliers, the number of retained cells is similar across settings:
</p>
<table border="1" cellpadding="4" cellspacing="0">
  <thead>
    <tr>
      <th>Dataset</th>
      <th>Total&nbsp;cells</th>
      <th>Outliers&nbsp;removed</th>
      <th>Cells&nbsp;kept</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>K4&nbsp;300</td><td>9 372</td><td>160</td><td>9 212</td></tr>
    <tr><td>K27&nbsp;300</td><td>10 024</td><td>178</td><td>9 846</td></tr>
    <tr><td>K4&nbsp;500</td><td>5 903</td><td>9</td><td>5 894</td></tr>
    <tr><td>K27&nbsp;500</td><td>10 017</td><td>182</td><td>9 835</td></tr>
  </tbody>
</table>

<p>
  <strong>K4, <code>minFrags = 300</code></strong>: outliers (red) before and after removal.
</p>
<img src="results/section8/minfrag300_K4_identify_outliers.png" width="500" alt="origin">
<img src="results/section8/minfrag300_K4_removeoutliers_umap.png" width="500" alt="origin">

<p>
  <strong>K27, <code>minFrags = 300</code></strong>: outliers (red) before and after removal.
</p>
<img src="results/section8/minfrag300_K27_identify_outliers.png" width="500" alt="origin">
<img src="results/section8/minfrag300_K27_removeoutliers_umap.png" width="500" alt="origin">


<h3>8.3 Obtain the bin-by-cell matrix that uses the same bins as the UMAP plot.</h3>
<ol>
  <li>Produce a Python-readable bin-by-cell matrix using the same bins as the UMAP.</li>
  <li>Build and benchmark the baseline aggregation algorithm.</li>
</ol>